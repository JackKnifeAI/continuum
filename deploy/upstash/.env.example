# Upstash Redis Configuration for CONTINUUM
# Copy this file to .env and fill in your credentials

# ============================================================================
# UPSTASH REST API (Required for serverless mode)
# ============================================================================
# Get these from: https://console.upstash.com → Database → REST API tab
UPSTASH_REDIS_REST_URL=https://your-database-name-12345.upstash.io
UPSTASH_REDIS_REST_TOKEN=AYg...your-rest-token...Z6Q==

# ============================================================================
# UPSTASH REDIS URL (Optional, for traditional Redis mode)
# ============================================================================
# Get this from: https://console.upstash.com → Database → Redis tab
# UPSTASH_REDIS_URL=redis://default:your-password@your-database.upstash.io:6379
# Or with TLS:
# UPSTASH_REDIS_URL=rediss://default:your-password@your-database.upstash.io:6379

# ============================================================================
# CONTINUUM CACHE CONFIGURATION
# ============================================================================

# Connection mode: "rest" (serverless), "redis" (traditional), or "auto" (detect)
# - Use "rest" for: Cloudflare Workers, AWS Lambda, Vercel, serverless
# - Use "redis" for: Docker, Kubernetes, long-running services
# - Use "auto" to auto-detect based on available credentials
CONTINUUM_CACHE_MODE=upstash

# Enable automatic failover to local in-memory cache if Upstash unavailable
# Recommended: true for production (graceful degradation)
CONTINUUM_CACHE_FALLBACK=true

# Connection pool size (for Redis mode only)
# Higher = more concurrent connections, more memory
UPSTASH_POOL_SIZE=10

# ============================================================================
# MULTIPLE DATABASES (Optional)
# ============================================================================
# Configure separate databases for different purposes:

# Primary cache (sessions, queries, memories) - allkeys-lru eviction
# UPSTASH_PRIMARY_REST_URL=https://primary-cache.upstash.io
# UPSTASH_PRIMARY_REST_TOKEN=your-token

# Sessions only - noeviction (persistence required)
# UPSTASH_SESSIONS_REST_URL=https://sessions.upstash.io
# UPSTASH_SESSIONS_REST_TOKEN=your-token

# Federation sync - global database for multi-region
# UPSTASH_FEDERATION_REST_URL=https://federation-global.upstash.io
# UPSTASH_FEDERATION_REST_TOKEN=your-token

# ============================================================================
# ADVANCED CONFIGURATION (Optional)
# ============================================================================

# Enable Upstash telemetry (helps improve service)
UPSTASH_ENABLE_TELEMETRY=false

# Default TTL for cached items (seconds)
# CONTINUUM_DEFAULT_TTL=300

# Use MessagePack serialization (30-50% smaller than JSON)
# CONTINUUM_USE_MSGPACK=true

# Health check interval (seconds) for automatic reconnection
# CONTINUUM_HEALTH_CHECK_INTERVAL=30

# ============================================================================
# COST OPTIMIZATION
# ============================================================================
# Tips to reduce costs:
# 1. Use aggressive TTLs to reduce storage
# 2. Use pipelines for batch operations (reduces command count)
# 3. Enable MessagePack serialization (reduces bandwidth)
# 4. Cache only frequently accessed data
# 5. Set up alerts in Upstash console for usage spikes

# ============================================================================
# SECURITY NOTES
# ============================================================================
# ⚠️  NEVER commit this file with real credentials to git!
# ⚠️  Add .env to .gitignore
# ⚠️  Rotate tokens quarterly
# ⚠️  Use platform-specific secret management in production:
#     - Kubernetes: kubectl create secret
#     - Cloudflare: wrangler secret
#     - Vercel: vercel env add
#     - AWS: Secrets Manager

# ============================================================================
# QUICK START
# ============================================================================
# 1. Create database at https://console.upstash.com
# 2. Copy REST URL and REST Token
# 3. Fill in UPSTASH_REDIS_REST_URL and UPSTASH_REDIS_REST_TOKEN above
# 4. Save as .env (remove .example extension)
# 5. Load: source .env  OR  export $(cat .env | xargs)
# 6. Test: python continuum/cache/upstash_example.py
